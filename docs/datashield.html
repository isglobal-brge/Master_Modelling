<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 DataSHIELD | Data Visualisation and Modelling</title>
  <meta name="description" content="6 DataSHIELD | Data Visualisation and Modelling" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="6 DataSHIELD | Data Visualisation and Modelling" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 DataSHIELD | Data Visualisation and Modelling" />
  
  
  

<meta name="author" content="Juan R González" />


<meta name="date" content="2021-10-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-fitting.html"/>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Visualisation and Modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html"><i class="fa fa-check"></i><b>2</b> Dealing with Big Data in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#nodes-cores-processes-and-threads"><i class="fa fa-check"></i><b>2.1</b> Nodes, cores, processes and threads</a></li>
<li class="chapter" data-level="2.2" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#paralelización"><i class="fa fa-check"></i><b>2.2</b> Paralelización</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#shared-memory-programming"><i class="fa fa-check"></i><b>2.2.1</b> Shared Memory Programming</a></li>
<li class="chapter" data-level="2.2.2" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#distributed-memory-programming"><i class="fa fa-check"></i><b>2.2.2</b> Distributed Memory Programming</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#mapreduce"><i class="fa fa-check"></i><b>2.3</b> MapReduce</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#map"><i class="fa fa-check"></i><b>2.3.1</b> Map</a></li>
<li class="chapter" data-level="2.3.2" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#reduce"><i class="fa fa-check"></i><b>2.3.2</b> Reduce</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="dealing-with-big-data-in-r.html"><a href="dealing-with-big-data-in-r.html#linear-regression-for-big-data"><i class="fa fa-check"></i><b>2.4</b> Linear regression for Big Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>3</b> Linear models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="linear-models.html"><a href="linear-models.html#ols-estimation-in-r"><i class="fa fa-check"></i><b>3.1</b> OLS estimation in R</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>4</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html#logistic-regression-with-r"><i class="fa fa-check"></i><b>4.1</b> Logistic regression with R</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-fitting.html"><a href="model-fitting.html"><i class="fa fa-check"></i><b>5</b> Model Fitting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="model-fitting.html"><a href="model-fitting.html#getting-started"><i class="fa fa-check"></i><b>5.1</b> Getting started</a></li>
<li class="chapter" data-level="5.2" data-path="model-fitting.html"><a href="model-fitting.html#general-rules-for-variable-selection"><i class="fa fa-check"></i><b>5.2</b> General rules for variable selection</a></li>
<li class="chapter" data-level="5.3" data-path="model-fitting.html"><a href="model-fitting.html#stepwise-variable-selection"><i class="fa fa-check"></i><b>5.3</b> Stepwise variable selection</a></li>
<li class="chapter" data-level="5.4" data-path="model-fitting.html"><a href="model-fitting.html#comparing-models"><i class="fa fa-check"></i><b>5.4</b> Comparing models</a></li>
<li class="chapter" data-level="5.5" data-path="model-fitting.html"><a href="model-fitting.html#automatic-variable-selection"><i class="fa fa-check"></i><b>5.5</b> Automatic variable selection</a></li>
<li class="chapter" data-level="5.6" data-path="model-fitting.html"><a href="model-fitting.html#cross-validation"><i class="fa fa-check"></i><b>5.6</b> Cross validation</a></li>
<li class="chapter" data-level="5.7" data-path="model-fitting.html"><a href="model-fitting.html#cross-validation-and-bootstrap"><i class="fa fa-check"></i><b>5.7</b> Cross-validation and Bootstrap</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="model-fitting.html"><a href="model-fitting.html#leave-one-out-cross-validation-loocv"><i class="fa fa-check"></i><b>5.7.1</b> Leave-one-out cross validation (LOOCV)</a></li>
<li class="chapter" data-level="5.7.2" data-path="model-fitting.html"><a href="model-fitting.html#k-fold-cross-validation-k-fold-cv"><i class="fa fa-check"></i><b>5.7.2</b> K-fold cross validation (K-fold CV)</a></li>
<li class="chapter" data-level="5.7.3" data-path="model-fitting.html"><a href="model-fitting.html#bootstrap"><i class="fa fa-check"></i><b>5.7.3</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="model-fitting.html"><a href="model-fitting.html#example-with-caret-library"><i class="fa fa-check"></i><b>5.8</b> Example with <code>caret</code> library</a></li>
<li class="chapter" data-level="5.9" data-path="model-fitting.html"><a href="model-fitting.html#missing-data-imputation"><i class="fa fa-check"></i><b>5.9</b> Missing data imputation</a></li>
<li class="chapter" data-level="5.10" data-path="model-fitting.html"><a href="model-fitting.html#regularization"><i class="fa fa-check"></i><b>5.10</b> Regularization</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="datashield.html"><a href="datashield.html"><i class="fa fa-check"></i><b>6</b> DataSHIELD</a>
<ul>
<li class="chapter" data-level="6.1" data-path="datashield.html"><a href="datashield.html#introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="datashield.html"><a href="datashield.html#opal"><i class="fa fa-check"></i><b>6.2</b> Opal</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="datashield.html"><a href="datashield.html#introduction-1"><i class="fa fa-check"></i><b>6.2.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2.2" data-path="datashield.html"><a href="datashield.html#data-management"><i class="fa fa-check"></i><b>6.2.2</b> Data Management</a></li>
<li class="chapter" data-level="6.2.3" data-path="datashield.html"><a href="datashield.html#security"><i class="fa fa-check"></i><b>6.2.3</b> Security</a></li>
<li class="chapter" data-level="6.2.4" data-path="datashield.html"><a href="datashield.html#r-integration"><i class="fa fa-check"></i><b>6.2.4</b> R Integration</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="datashield.html"><a href="datashield.html#resources"><i class="fa fa-check"></i><b>6.3</b> The Resources</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="datashield.html"><a href="datashield.html#concept"><i class="fa fa-check"></i><b>6.3.1</b> Concept</a></li>
<li class="chapter" data-level="6.3.2" data-path="datashield.html"><a href="datashield.html#types"><i class="fa fa-check"></i><b>6.3.2</b> Types</a></li>
<li class="chapter" data-level="6.3.3" data-path="datashield.html"><a href="datashield.html#definition"><i class="fa fa-check"></i><b>6.3.3</b> Definition</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="datashield.html"><a href="datashield.html#datashield-r-interface-dsi"><i class="fa fa-check"></i><b>6.4</b> DataSHIELD R Interface (DSI)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="datashield.html"><a href="datashield.html#class-structures"><i class="fa fa-check"></i><b>6.4.1</b> Class Structures</a></li>
<li class="chapter" data-level="6.4.2" data-path="datashield.html"><a href="datashield.html#higher-level-functions"><i class="fa fa-check"></i><b>6.4.2</b> Higher Level Functions</a></li>
<li class="chapter" data-level="6.4.3" data-path="datashield.html"><a href="datashield.html#options"><i class="fa fa-check"></i><b>6.4.3</b> Options</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="datashield.html"><a href="datashield.html#datashieldopal-implementation"><i class="fa fa-check"></i><b>6.5</b> DataSHIELD/Opal Implementation</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="datashield.html"><a href="datashield.html#client"><i class="fa fa-check"></i><b>6.5.1</b> Client</a></li>
<li class="chapter" data-level="6.5.2" data-path="datashield.html"><a href="datashield.html#server"><i class="fa fa-check"></i><b>6.5.2</b> Server</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="datashield.html"><a href="datashield.html#demo-basic-statistical-analyses"><i class="fa fa-check"></i><b>6.6</b> Demo: Basic statistical analyses</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="datashield.html"><a href="datashield.html#analysis-from-a-single-study"><i class="fa fa-check"></i><b>6.6.1</b> Analysis from a single study</a></li>
<li class="chapter" data-level="6.6.2" data-path="datashield.html"><a href="datashield.html#analysis-from-multiple-studies"><i class="fa fa-check"></i><b>6.6.2</b> Analysis from multiple studies</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="datashield.html"><a href="datashield.html#tips-and-tricks"><i class="fa fa-check"></i><b>6.7</b> Tips and tricks</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="datashield.html"><a href="datashield.html#how-to-create-a-new-project-into-opal"><i class="fa fa-check"></i><b>6.7.1</b> How to create a new project into OPAL</a></li>
<li class="chapter" data-level="6.7.2" data-path="datashield.html"><a href="datashield.html#how-to-upload-a-new-resource-into-opal"><i class="fa fa-check"></i><b>6.7.2</b> How to upload a new resource into OPAL</a></li>
<li class="chapter" data-level="6.7.3" data-path="datashield.html"><a href="datashield.html#how-to-install-datashield-packages-into-opal-server"><i class="fa fa-check"></i><b>6.7.3</b> How to install DataSHIELD packages into OPAL server</a></li>
<li class="chapter" data-level="6.7.4" data-path="datashield.html"><a href="datashield.html#how-to-install-r-packages-into-opal-server"><i class="fa fa-check"></i><b>6.7.4</b> How to install R packages into OPAL server</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Visualisation and Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datashield" class="section level1" number="6">
<h1><span class="header-section-number">6</span> DataSHIELD</h1>
<div id="introduction" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
<p>Some research projects require pooling data from several studies to obtain sample sizes large and diverse enough for detecting interactions. Unfortunately, important ethico-legal constraints often prevent or impede the sharing of individual-level data across multiple studies. DataSHIELD aims to address this issue. DataSHIELD is a method that enables advanced statistical analysis of individual-level data from several sources without actually pooling the data from these sources together. DataSHIELD facilitates important research in settings where:</p>
<ul>
<li>a co-analysis of individual-level data from several studies is scientifically necessary but governance restrictions prevent the release or sharing of some of the required data, and/or render data access unacceptably slow,</li>
<li>equivalent governance concerns prevent or hinder access to a single dataset,</li>
<li>a research group wishes to actively share the information held in its data with others but does not wish to cede control of the governance of those data and/or the intellectual property they represent by physically handing over the data themselves,</li>
<li>a dataset which is to be remotely analysed, or included in a multi-study co-analysis, contains data objects (e.g. images) which are too large to be physically transferred to the analysis location.</li>
</ul>
<p>A typical DataSHIELD infrastructure (see Figure <a href="datashield.html#fig:dsArchitec">6.1</a>) is composed of one analysis node (the DataSHIELD client) connected to one or several data analysis nodes (the DataSHIELD servers). In each of these server nodes, there is an R server application which can only be accessed through a DataSHIELD-compliant middleware application. This middleware application acts as a broker for managing R server sessions in a multi-user environment, assigning data and launching analysis on the R server. The analysis execution environment is then fully controlled: users must be authenticated, must have the proper permissions to access the data of interest and can only perform some predefined assignment and aggregation operations. Importantly, the operations that are permitted are designed to prevent the user having access to individual data items while still allowing useful work to be done with the data. For example, users can fit a generalised linear model to a dataset and receive information about the model coefficients, but are not given the residuals, as these could be used to reconstruct the original data.The reference implementation of this DataSHIELD infrastructure is based on the <a href="http://opaldoc.obiba.org/">Opal</a> data repository.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:dsArchitec"></span>
<img src="fig/singleSiteDSInfrastructure.jpg" alt="Typical DataSHIELD infrastructure, including one central analysis node (client) and several data nodes (servers). " width="80%" />
<p class="caption">
Figure 6.1: Typical DataSHIELD infrastructure, including one central analysis node (client) and several data nodes (servers).
</p>
</div>
<p>The client node interacts programmatically in R with the server nodes using the DataSHIELD Interface implemented as the <a href="https://cran.r-project.org/package=DSI">DSI</a> R package. The DSI defines prototype functions to authenticate the user and to perform assignment and aggregation operations in each of the R servers sitting in the server nodes. The reference implementation of DSI is the <a href="https://cran.r-project.org/package=DSOpal">DSOpal</a> R package. An alternate implementation of DSI is <a href="https://cran.r-project.org/package=DSLite">DSLite</a>, an R package targetted at DataSHIELD developers by offering a lightweight, pure R implementation of the whole DataSHIELD infrastructure.</p>
</div>
<div id="opal" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Opal</h2>
<div id="introduction-1" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Introduction</h3>
<p>Opal is <a href="https://www.obiba.org/">OBiBa</a>’s core database application for epidemiological studies. Participant data, collected by questionnaires, medical instruments, sensors, administrative databases etc. can be integrated and stored in a central data repository under a uniform model. Opal is a web application that can import, process, copy data and has advanced features for cataloging the data (fully described, annotated and searchable data dictionaries) as recommended by the <a href="https://www.maelstrom-research.org">Maelstrom Research</a> group at McGill University, Canada. Opal is typically used by a research center to analyze the data acquired from assessment centres. Its ultimate purpose is to achieve seamless data-sharing among epidemiological studies. Opal is the reference implementation of the <a href="http://www.datashield.ac.uk/">DataSHIELD</a> infrastructure. More information on Opal can be found in the <a href="https://www.obiba.org/pages/products/opal/">Opal description on OBiBa</a>.</p>
<p>Opal provides the following main features:</p>
<ul>
<li>Use of MongoDB, Mysql, MariaDB and/or PostgreSQL as database software backends,</li>
<li>Import of data from various file formats (CSV, SPSS, SAS, Stata etc.) and from SQL databases,</li>
<li>Export of data to various file formats (CSV, SPSS, SAS, Stata etc.) and to SQL databases,</li>
<li>Plugin architecture to extend import/export capabilities, for instance by connecting to data source software such as REDCap, LimeSurvey etc.,</li>
<li>Storage of data about any type of “entity”, such as subject, sample, geographic area, etc.,</li>
<li>Storage of data of any type (e.g., texts, numbers, geo-localisation, images, videos, etc.),</li>
<li>Advanced authentication and authorization features,</li>
<li>Reporting using R markdown,</li>
<li>Data analysis plugins using R,</li>
<li>Web services can be accessed using R, Python, Java, Javascript,</li>
<li>DataSHIELD middleware reference implementation (configuration, access controls, R session management).</li>
</ul>
</div>
<div id="data-management" class="section level3" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Data Management</h3>
<p>In Opal the data sets are represented by tables, which are grouped by projects. A table has variables (columns) and entity values (rows). Opal also has the concept of views, which are logical tables where the variables are derived from physical tables via scripts. The storage of the data and of the meta-data (data dictionaries) is managed in a database (for example, a SQL database such as MySQL, MariaDB or PostgreSQL, or a document-oriented database such as MongoDB).</p>
<p>Detailed concepts and tutorials for tables can be found here:</p>
<ul>
<li><a href="http://opaldoc.obiba.org/en/latest/variables-data.html">Variables and Data</a></li>
<li><a href="http://opaldoc.obiba.org/en/latest/ids.html">Identifiers Mappings</a></li>
<li><a href="http://opaldoc.obiba.org/en/latest/data-harmonization.html">Data Harmonization</a></li>
</ul>
</div>
<div id="security" class="section level3" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Security</h3>
<p>All Opal operations are accessible through web services that require authentication and proper authorization. The permissions can be granted to a specific user or a group of users, can be applied to a project or to a table and have different levels: <em>read-only meta-data</em> (access to the data dictionary without access to the individual-level data), <em>read-only</em>, or <em>write</em> permissions. The programmatic authentication can make use of <em>username/password</em> credentials, <em>token</em> or <em>2-way SSL</em> authentication methods. Opal can also integrate with the hosting institution’s users registry using the <a href="https://openid.net/connect/">OpenID Connect</a> standard.</p>
</div>
<div id="r-integration" class="section level3" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> R Integration</h3>
<p>Opal connects to a R server to perform different kind of operations:</p>
<ul>
<li>data import/export (using R packages),</li>
<li>data analysis (by transfering data from Opal’s database into a R server session and using R packages).</li>
</ul>
<p>The R server is based on the <a href="https://cran.r-project.org/package=Rserve">Rserve</a> R package. The user R sessions that are running in this R server are managed by Opal.</p>
<p>This Opal/R integration works well for small to mid-size datasets (usually less than 10M data points). For bigger datasets, extracting and transferring data from the database to the R server is time, CPU and memory intensive. In this work, we will present a more flexible data description paradigm called <a href="datashield.html#resources">resources</a> that enables Opal to manage access to Big Data sets, complex data structures and computation units for analysis purpose, while still having the security and the analysis features provided by Opal.</p>
<div id="opal-demo-site" class="section level4" number="6.2.4.1">
<h4><span class="header-section-number">6.2.4.1</span> Opal demo site</h4>
<p>We have set up an <a href="http://opal-demo.obiba.org/">Opal demo site</a> to illustrate how to perform some basic analyses using DataSHIELD as well as how to deal with different <em>resources</em> for ’omic data. The Opal server can be accessed with the credentials:</p>
<ul>
<li>username: <code>administrator</code></li>
<li>password: <code>password</code></li>
</ul>
<p>In this figure we can see all the projects available.</p>
<div class="figure">
<img src="fig/opal_projects.png" alt="" />
<p class="caption">Opal demo site available projects</p>
</div>
<p>This vignette will mainly make use of the resources available at <code>RSRC</code> project</p>
<div class="figure">
<img src="fig/resources_rsrc.png" alt="" />
<p class="caption">Resources available at Opal demo site of RSRC project</p>
</div>
<p>In order to make the reader familiar with Opal we recommend visiting <a href="http://opaldoc.obiba.org/">the Opal online documentation</a>.</p>
</div>
</div>
</div>
<div id="resources" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> The Resources</h2>
<p>Developing and implementing new algorithms to perform advanced data analyses under the DataSHIELD framework is a current active line of research. However, the analysis of big data within DataSHIELD has some limitations. Some of them are related to how data is managed in Opal’s database and others are related to how to perform statistical analyses of big data within the R environment. Opal databases are for general purpose and do not manage large amounts of information properly and, second, it requires data to be moved from original repositories into Opal which is inefficient (this is a time, CPU and memory intensive operation) and is difficult to maintain when data are updated. We have overcome the problem related to DataSHIELD big data management by developing a new data infrastructure within Opal: <strong>the resources</strong>.</p>
<div id="concept" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Concept</h3>
<p>Resources are datasets or computation units whose location is described by a URL and access is protected by credentials. When assigned to a R/DataSHIELD server session, remote big/complex datasets or high performance computers are made accessible to data analysts.</p>
<p>Instead of storing the data in Opal’s database, only the way to access it is defined: the datasets are kept in their original format and location (a SQL database, a SPSS file, R object, etc.) and are read directly from the R/DataSHIELD server-side session. Then as soon as there is a R reader for the dataset or a connector for the analysis services, a resource can be defined. Opal takes care of the DataSHIELD permissions (a DataSHIELD user cannot see the resource’s credentials) and of the resources assignment to a R/DataSHIELD session (see Figure <a href="datashield.html#fig:resources">6.2</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:resources"></span>
<img src="fig/resourcer_fig.jpg" alt="Resources: a new DataSHIELD infrastructure" width="40%" />
<p class="caption">
Figure 6.2: Resources: a new DataSHIELD infrastructure
</p>
</div>
</div>
<div id="types" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Types</h3>
<p>The data format refers to the intrinsic structure of the data. A very common family of data formats is the <a href="https://en.wikipedia.org/wiki/Table_(information)">tabular format</a> which is made of rows (entities, records, observations etc.) and columns (variables, fields, vectors etc.). Examples of tabular formats are the <a href="https://en.wikipedia.org/wiki/Delimiter-separated_values">delimiter-separated values formats</a> (CSV, TSV etc.), the <a href="https://en.wikipedia.org/wiki/Spreadsheet">spreadsheet</a> data formats (Microsoft Excel, LibreOffice Calc, Google Sheets etc.), some proprietary statistical software data formats (SPSS, SAS, Stata etc.), the <a href="https://en.wikipedia.org/wiki/Table_(database)">database tables</a> that can be stored in structured database management systems that are row-oriented (MySQL, MariaDB, PostgreSQL, Oracle, SQLite etc.) or column-oriented (Apache Cassandra, Apache Parquet, MariaDB ColumnStore, BigTable etc.), or in semi-structured database management systems such as the documented-oriented databases (MongoDB, Redis, CouchDB, Elasticsearch etc.).</p>
<p>When the data model is more complex (data types and objects relationships), a domain-specific data format is sometimes designed to handle this complexity so that statistical analysis and data retrieval can be executed as efficiently as possible. Examples of domain-specific data formats that are encountered in the ’omic or geospatial fields of research that are described in the Workflows section: <a href="#Omic">Omic</a> and <a href="#GIS">Geospatial</a>. A data format can also include some additional features such as data compression, encoding or encryption. Each data format requires an appropriate reader software library or application to extract the information or perform data aggregation or filtering operations.</p>
<p>We have prepared a demo environment, with the Opal implementation of Resources and an appropriate R/DataSHIELD configuration that is available at: <a href="https://opal-demo.obiba.org">opal-demo.obiba.org</a> in a project called <code>RSRC</code>. This figure illustrate the resources which are available for this project and can serve as a starting example of the different types of resources that can be dealt with</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:testResources"></span>
<img src="fig/opal_resources.png" alt="Resources from a test enviroment (project called RSRC) available at https://opal-demo.obiba.org"  />
<p class="caption">
Figure 6.3: Resources from a test enviroment (project called RSRC) available at <a href="https://opal-demo.obiba.org" class="uri">https://opal-demo.obiba.org</a>
</p>
</div>
<p>As shown in this example, the data storage can simply be a file accessed directly from the host’s file system or downloaded from a remote location. More advanced data storage systems are software applications that expose an interface to query, extract or analyse the data. These applications can make use of a standard programming interface (e.g. SQL) or expose specific web services (e.g. based on the HTTP communication protocol) or provide a software library (in different programming languages) to access the data. These different ways of accessing the data are not exclusive from each other. In some cases the micro-data cannot be extracted, only computation services that return aggregated data are provided. The data storage system can also apply security rules, requiring authentication and proper authorisations to access or analyse the data.</p>
</div>
<div id="definition" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Definition</h3>
<p>We define a resource to be a data or computation access description. A resource will have the following properties:</p>
<ul>
<li>the <strong>location</strong> of the data or of the computation services,</li>
<li>the <strong>data format</strong> (if this information cannot be inferred from the location property),</li>
<li>the <strong>access credentials</strong> (if some apply).</li>
</ul>
<p>The resource location description will make use of the web standard described in the <a href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> “Uniform Resource Identifier (URI): Generic Syntax”. More specifically, the Uniform Resource Locator (URL) specification is what we need for defining the location of the data or computation resource: the term Uniform allows to describe the resource the same way, independently of its type, location and usage context; the term Resource does not limit the scope of what might be a resource, e.g. a document, a service, a collection of resources, or even abstract concepts (operations, relationships, etc.); the term Locator both identifies the resource and provides a means of locating it by describing its access mechanism (e.g. the network location). The URL syntax is composed of several parts:</p>
<ul>
<li>a <em>scheme</em>, that describes how to access the resource, e.g. the communication protocols “https” (secured HTTP communication), “ssh” (secured shell, for issuing commands on a remote server), or “s3” (for accessing Amazon Web Service S3 file store services),</li>
<li>an <em>authority</em> (optional), e.g. a server name address,</li>
<li>a <em>path</em> that identifies/locates the resource in a hierarchical way and that can be altered by query parameters.</li>
</ul>
<p>The resource’s data format might be inferred from the path part of the URL, by using the file name suffix for instance. Nevertheless, sometimes it is not possible to identify the data format because the path might only descripbe the data storage system, for example when a file store designates a document using an obfuscated string identifier or when a text-based data format is compressed as a zip archive. The format property can provide this information.</p>
<p>Although the authority section of the URL can contain some user information (such as the username and password), it is discouraged to use this capability for security considerations. The resource’s credentials property will be used instead, and will be composed of an identifier sub-property and a secret sub-property, which can be used for authenticating with a username/password, or an access token, or any other credentials encoded string. The advantage of separating the credentials property from the resource location property is that a user with limited permissions could have access to the resource’s location information while the credentials are kept secret.</p>
<p>Once a resource has been formally defined, it should be possible to build programmatically a connection object that will make use of the data or computation services described. This resource description is not bound to a specific programmatic language (the URL property is a web standard, other properties are simple strings) and does not enforce the use of a specific software application for building, storing and interpreting a resource object.</p>
<p>The <em><a href="https://CRAN.R-project.org/package=resourcer">resourcer</a></em> package is an R implementation of the data and computation resources description and connection. There the reader can see some examples of how dealing with different resources in DataSHIELD <a href="https://isglobal-brge.github.io/resource_bookdown/resourcer.html">here</a>.</p>
</div>
</div>
<div id="datashield-r-interface-dsi" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> DataSHIELD R Interface (DSI)</h2>
<p>The DataSHIELD Interface (DSI) defines a set of <a href="http://adv-r.had.co.nz/S4.html">S4 classes and generic methods</a> that can be implemented for accessing a data repository supporting the DataSHIELD infrastructure: controlled R commands to be executed on the server side that ensure only non disclosive information is returned to client side.</p>
<div id="class-structures" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Class Structures</h3>
<p>The DSI S4 classes are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Class</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>DSObject</code></td>
<td align="left">A common base class for all DSI,</td>
</tr>
<tr class="even">
<td align="left"><code>DSDriver</code></td>
<td align="left">A class to drive the creation of a connection object,</td>
</tr>
<tr class="odd">
<td align="left"><code>DSConnection</code></td>
<td align="left">Allows the interaction with the remote server; DataSHIELD operations such as aggregation and assignment return a result object; DataSHIELD setup status check can be performed (dataset access, configuration comparision),</td>
</tr>
<tr class="even">
<td align="left"><code>DSResult</code></td>
<td align="left">Wraps access to the result, which can be fetched either synchronously or asynchronously depending on the capabilities of the data repository server.</td>
</tr>
</tbody>
</table>
<p>All classes are <em>virtual</em>: they cannot be instantiated directly and instead must be subclassed. See <a href="https://github.com/datashield/DSOpal">DSOpal</a> for a reference implementation of DSI based on the <a href="http://opaldoc.obiba.org/">Opal</a> data repository.</p>
<p>These S4 classes and generic methods are meant <strong>to be used for implementing connections to a DataSHIELD-aware data repository.</strong></p>
</div>
<div id="higher-level-functions" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Higher Level Functions</h3>
<p>In addition to these S4 classes, DSI provides functions to handle a list of remote data repository servers:</p>
<table>
<thead>
<tr class="header">
<th align="left">Functions</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>datashield.login</code></td>
<td align="left">Create <code>DSConnection</code> objects for the data repositories, using the <code>DSDriver</code> specification.</td>
</tr>
<tr class="even">
<td align="left"><code>datashield.logout</code></td>
<td align="left">Destroy the <code>DSConnection</code>s objects.</td>
</tr>
<tr class="odd">
<td align="left"><code>datashield.aggregate</code>, <code>datashield.assign</code></td>
<td align="left">Typical DataSHIELD operations on <code>DSConnection</code> objects; results can be fetched through <code>DSResult</code> objects.</td>
</tr>
<tr class="even">
<td align="left"><code>datashield.connections</code>, <code>datashield.connections_default</code>, <code>datashield.connections_find</code></td>
<td align="left">Management of the list of <code>DSConnection</code> objects that can be discovered and used by the client-side analytic functions.</td>
</tr>
<tr class="odd">
<td align="left"><code>datashield.workspaces</code>, <code>datashield.workspace_save</code>, <code>datashield.workspace_rm</code></td>
<td align="left">Manage R images of the remote DataSHIELD sessions (to speed up restoration of data analysis sessions).</td>
</tr>
<tr class="even">
<td align="left"><code>datashield.symbols</code>, <code>datashield.symbol_rm</code></td>
<td align="left">Minimalistic management of the R symbols living in the remote DataSHIELD sessions.</td>
</tr>
<tr class="odd">
<td align="left"><code>datashield.tables</code>, <code>datashield.table_status</code></td>
<td align="left">List the tables and their accessibility across a set of data repositories.</td>
</tr>
<tr class="even">
<td align="left"><code>datashield.resources</code>, <code>datashield.resource_status</code></td>
<td align="left">List the resources and their accessibility across a set of data repositories.</td>
</tr>
<tr class="odd">
<td align="left"><code>datashield.pkg_status</code>, <code>datashield.method_status</code>, <code>datashield.methods</code></td>
<td align="left">Utility functions to explore the DataSHIELD setup across a set of data repositories.</td>
</tr>
</tbody>
</table>
<p>These <code>datashield.*</code> functions are meant <strong>to be used by DataSHIELD packages developers and users.</strong></p>
</div>
<div id="options" class="section level3" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Options</h3>
<p>Some options can be set to modify the behavior of the DSI:</p>
<table>
<thead>
<tr class="header">
<th align="left">Option</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>datashield.env</code></td>
<td align="left">The R environment in which the <code>DSConnection</code> object list is to be looked for. Default value is the Global Environment: <code>globalenv()</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>datashield.progress</code></td>
<td align="left">A logical to enable visibility of progress bars. Default value is <code>TRUE</code>.</td>
</tr>
<tr class="odd">
<td align="left"><code>datashield.progress.clear</code></td>
<td align="left">A logical to make the progress bar disappear after it has been completed. Default value is <code>FALSE</code>.</td>
</tr>
<tr class="even">
<td align="left"><code>datashield.error.stop</code></td>
<td align="left">A logical to alter error handling behavior: if <code>TRUE</code> an error is raised when at least one server has failed, otherwise a warning message is issued. Default value is <code>TRUE</code>.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="datashieldopal-implementation" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> DataSHIELD/Opal Implementation</h2>
<p><a href="datashield.html#opal">Opal</a> is a web application that is accessible through web services. It implements DataSHIELD methods thanks to the following built-in features:</p>
<ul>
<li>integration with an R server, where the DataSHIELD operations will take place,</li>
<li>secure data management, with fine-grained permissions (to restrict access to individual level data),</li>
<li>web services API, that allows Opal operations to be run from an R script.</li>
</ul>
<p>In addition to these features, Opal manages the DataSHIELD configuration which consists of declaring the set of permitted aggregation/assignment R functions and some R options.</p>
<div id="client" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Client</h3>
<p>The <a href="https://cran.r-project.org/package=opalr">opalr</a> R package is a general purpose Opal connection R library (authentication is required) that is used to perform various operations (authorization may be required). The <a href="https://cran.r-project.org/package=DSOpal">DSOpal</a> R package is an implementation of the <em>DSI</em>, built on top of <em>opalr</em>. All the DataSHIELD operations are transparently applied to one or more Opal server using the <a href="datashield.html#higher-level-functions">DSI higher-level functions</a>. Opal also supports asynchronous function calls (submission of a R operation, then later retrieval of the result) which allows operations on several DataSHIELD analysis nodes in parallel.</p>
</div>
<div id="server" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Server</h3>
<p>On the R server managed by Opal, some DataSHIELD-compliant R packages can be managed using the Opal’s web interface: installation, removal of DataSHIELD-compliant R packages and automatic DataSHIELD configuration discovery. Opal guarantees that only the allowed functions can be called. The DataSHIELD-compliant R package guarantees that only aggregated results are returned to the client. The term ‘aggregated’ here means that the data in the R server will go through a function that summarizes individual-level data into a non-disclosive form. For example, obtaining the length of a vector, or obtaining the summary statistics of a vector (min, max, mean, etc.).</p>
<p>These DataSHIELD functions are customisable. That is, administrators of the Opal server can add, remove, modify or create completely custom aggregating methods that are proposed to DataSHIELD clients.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:opalDSAdmin"></span>
<img src="fig/opal_datashield_admin.png" alt="DataSHIELD configuration in Opal" width="90%" />
<p class="caption">
Figure 6.4: DataSHIELD configuration in Opal
</p>
</div>
<p>When performing a DataSHIELD analysis session, a typical workflow on a single Opal analysis node is the following:</p>
<ul>
<li>authentication of the user (requires authorization to use DataSHIELD service),</li>
<li>creation and initialization of an R server session,</li>
<li>assignment of Opal-managed data into the R server session (requires data access authorization),</li>
<li>processing incoming R operation requests (aggregation and assignment function calls requires authorization) that are forwarded to the R server session; non-disclosive aggregated result is then returned to the R client.</li>
</ul>
</div>
</div>
<div id="demo-basic-statistical-analyses" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Demo: Basic statistical analyses</h2>
<p>Let us start by illustrating how to peform simple statistical data analyses using different resources. Here, we will use data from three studies that are available in our Opal demo repository. The three databases are called CNSIM1, CNSIM2, CNSIM3 and are available as three different resources: mySQL database, SPSS file and CSV file (see Figure <a href="datashield.html#fig:testResources">6.3</a>). This example mimics real situations where different hospitals or research centers manage their own databases containing harmonized data. Data correspond to three simulated datasets with different numbers of observations of 11 harmonized variables. They contain synthetic data based on a model derived from the participants of the 1958 Birth Cohort, as part of an obesity methodological development project. This dataset does contain some NA values. The available variables are:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Note
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LAB_TSC
</td>
<td style="text-align:left;">
Total Serum Cholesterol
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
mmol/L
</td>
</tr>
<tr>
<td style="text-align:left;">
LAB_TRIG
</td>
<td style="text-align:left;">
Triglycerides
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
mmol/L
</td>
</tr>
<tr>
<td style="text-align:left;">
LAB_HDL
</td>
<td style="text-align:left;">
HDL Cholesterol
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
mmol/L
</td>
</tr>
<tr>
<td style="text-align:left;">
LAB_GLUC_ADJUSTED
</td>
<td style="text-align:left;">
Non-Fasting Glucose
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
mmol/L
</td>
</tr>
<tr>
<td style="text-align:left;">
PM_BMI_CONTINUOUS
</td>
<td style="text-align:left;">
Body Mass Index (continuous)
</td>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
kg/m2
</td>
</tr>
<tr>
<td style="text-align:left;">
DIS_CVA
</td>
<td style="text-align:left;">
History of Stroke
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
0 = Never had stroke; 1 = Has had stroke
</td>
</tr>
<tr>
<td style="text-align:left;">
MEDI_LPD
</td>
<td style="text-align:left;">
Current Use of Lipid Lowering Medication (from categorical assessment item)
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
0 = Not currently using lipid lowering medication; 1 = Currently using lipid lowering medication
</td>
</tr>
<tr>
<td style="text-align:left;">
DIS_DIAB
</td>
<td style="text-align:left;">
History of Diabetes
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
0 = Never had diabetes; 1 = Has had diabetes
</td>
</tr>
<tr>
<td style="text-align:left;">
DIS_AMI
</td>
<td style="text-align:left;">
History of Myocardial Infarction
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
0 = Never had myocardial infarction; 1 = Has had myocardial infarction
</td>
</tr>
<tr>
<td style="text-align:left;">
GENDER
</td>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
0 = Female, 1 = Male
</td>
</tr>
<tr>
<td style="text-align:left;">
PM_BMI_CATEGORICAL
</td>
<td style="text-align:left;">
Body Mass Index (categorical)
</td>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
1 = Less than 25 kg/m2; 2 = 25 to 30 kg/m2; 3 = Over 30 kg/m2
</td>
</tr>
</tbody>
</table>
<p>The analyses that are described here, can also be found in the <a href="https://data2knowledge.atlassian.net/wiki/spaces/DSDEV/pages/714571780/Tutorial+for+DataSHIELD+users+v5+-+http+bit.ly+intro-DS">DataSHIELD Tutorial</a> where these resources here uploaded to the Opal server as three tables, an inferior approach since data have to be moved from their original repositories.</p>
<div id="analysis-from-a-single-study" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Analysis from a single study</h3>
<p>Let us start by illustrating how to analyze one data set (CNSIM2).</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="datashield.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DSOpal)</span>
<span id="cb167-2"><a href="datashield.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsBaseClient)</span>
<span id="cb167-3"><a href="datashield.html#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="datashield.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare login data and resource to assign</span></span>
<span id="cb167-5"><a href="datashield.html#cb167-5" aria-hidden="true" tabindex="-1"></a>builder <span class="ot">&lt;-</span> DSI<span class="sc">::</span><span class="fu">newDSLoginBuilder</span>()</span>
<span id="cb167-6"><a href="datashield.html#cb167-6" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server =</span> <span class="st">&quot;study1&quot;</span>, <span class="at">url =</span> <span class="st">&quot;https://opal-demo.obiba.org&quot;</span>, </span>
<span id="cb167-7"><a href="datashield.html#cb167-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">user =</span> <span class="st">&quot;dsuser&quot;</span>, <span class="at">password =</span> <span class="st">&quot;password&quot;</span>, </span>
<span id="cb167-8"><a href="datashield.html#cb167-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">resource =</span> <span class="st">&quot;RSRC.CNSIM1&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;OpalDriver&quot;</span>)</span>
<span id="cb167-9"><a href="datashield.html#cb167-9" aria-hidden="true" tabindex="-1"></a>logindata <span class="ot">&lt;-</span> builder<span class="sc">$</span><span class="fu">build</span>()</span>
<span id="cb167-10"><a href="datashield.html#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="datashield.html#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="co"># login and assign resource</span></span>
<span id="cb167-12"><a href="datashield.html#cb167-12" aria-hidden="true" tabindex="-1"></a>conns <span class="ot">&lt;-</span> DSI<span class="sc">::</span><span class="fu">datashield.login</span>(<span class="at">logins =</span> logindata, <span class="at">assign =</span> <span class="cn">TRUE</span>, </span>
<span id="cb167-13"><a href="datashield.html#cb167-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">symbol =</span> <span class="st">&quot;res&quot;</span>)</span>
<span id="cb167-14"><a href="datashield.html#cb167-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-15"><a href="datashield.html#cb167-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-16"><a href="datashield.html#cb167-16" aria-hidden="true" tabindex="-1"></a><span class="co"># coerce ResourceClient objects to a data.frame called &#39;D&#39;</span></span>
<span id="cb167-17"><a href="datashield.html#cb167-17" aria-hidden="true" tabindex="-1"></a><span class="fu">datashield.assign.expr</span>(conns, <span class="at">symbol =</span> <span class="st">&quot;D&quot;</span>, </span>
<span id="cb167-18"><a href="datashield.html#cb167-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expr =</span> <span class="fu">quote</span>(<span class="fu">as.resource.data.frame</span>(res, <span class="at">strict=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<p>Then we can inspect the type of data we have</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="datashield.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.class</span>(<span class="st">&quot;D&quot;</span>)</span></code></pre></div>
<pre><code>$study1
[1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="datashield.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.colnames</span>(<span class="st">&quot;D&quot;</span>)</span></code></pre></div>
<pre><code>$study1
 [1] &quot;id&quot;                 &quot;LAB_TSC&quot;            &quot;LAB_TRIG&quot;           &quot;LAB_HDL&quot;            &quot;LAB_GLUC_ADJUSTED&quot; 
 [6] &quot;PM_BMI_CONTINUOUS&quot;  &quot;DIS_CVA&quot;            &quot;MEDI_LPD&quot;           &quot;DIS_DIAB&quot;           &quot;DIS_AMI&quot;           
[11] &quot;GENDER&quot;             &quot;PM_BMI_CATEGORICAL&quot;</code></pre>
<p>Perform some data descriptive analyses</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="datashield.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.table</span>(<span class="st">&quot;D$DIS_DIAB&quot;</span>)</span></code></pre></div>
<pre><code>
 Data in all studies were valid 

Study 1 :  No errors reported from this study</code></pre>
<pre><code>$output.list
$output.list$TABLE_rvar.by.study_row.props
          study
D$DIS_DIAB study1
         0      1
         1      1

$output.list$TABLE_rvar.by.study_col.props
          study
D$DIS_DIAB     study1
         0 0.98613037
         1 0.01386963

$output.list$TABLE_rvar.by.study_counts
          study
D$DIS_DIAB study1
         0   2133
         1     30

$output.list$TABLES.COMBINED_all.sources_proportions
D$DIS_DIAB
     0      1 
0.9860 0.0139 

$output.list$TABLES.COMBINED_all.sources_counts
D$DIS_DIAB
   0    1 
2133   30 


$validity.message
[1] &quot;Data in all studies were valid&quot;</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="datashield.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.table</span>(<span class="st">&quot;D$DIS_DIAB&quot;</span>, <span class="st">&quot;D$GENDER&quot;</span>)</span></code></pre></div>
<pre><code>
 Data in all studies were valid 

Study 1 :  No errors reported from this study</code></pre>
<pre><code>$output.list
$output.list$TABLE.STUDY.study1_row.props
          D$GENDER
D$DIS_DIAB     0     1
         0 0.502 0.498
         1 0.700 0.300

$output.list$TABLE.STUDY.study1_col.props
          D$GENDER
D$DIS_DIAB      0      1
         0 0.9810 0.9920
         1 0.0192 0.0084

$output.list$TABLES.COMBINED_all.sources_row.props
          D$GENDER
D$DIS_DIAB     0     1
         0 0.502 0.498
         1 0.700 0.300

$output.list$TABLES.COMBINED_all.sources_col.props
          D$GENDER
D$DIS_DIAB      0      1
         0 0.9810 0.9920
         1 0.0192 0.0084

$output.list$TABLE_STUDY.study1_counts
          D$GENDER
D$DIS_DIAB    0    1
         0 1071 1062
         1   21    9

$output.list$TABLES.COMBINED_all.sources_counts
          D$GENDER
D$DIS_DIAB    0    1
         0 1071 1062
         1   21    9


$validity.message
[1] &quot;Data in all studies were valid&quot;</code></pre>
<p>Or even some statistical modelling. In this case we want to assess whether sex (GENDER) or triglycerides (LAB_TRIG) are risk factors for diabetes (DIS_DIAB)</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="datashield.html#cb178-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">ds.glm</span>(DIS_DIAB <span class="sc">~</span> LAB_TRIG <span class="sc">+</span> GENDER, <span class="at">data =</span> <span class="st">&quot;D&quot;</span> , <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb178-2"><a href="datashield.html#cb178-2" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>coeff</span></code></pre></div>
<pre><code>              Estimate Std. Error    z-value      p-value low0.95CI.LP high0.95CI.LP        P_OR
(Intercept) -5.1696619  0.4549328 -11.363572 6.349427e-30   -6.0613138    -4.2780099 0.005654338
LAB_TRIG     0.3813891  0.1037611   3.675647 2.372471e-04    0.1780211     0.5847570 1.464317247
GENDER      -0.2260851  0.4375864  -0.516664 6.053908e-01   -1.0837387     0.6315685 0.797650197
            low0.95CI.P_OR high0.95CI.P_OR
(Intercept)    0.002325913      0.01368049
LAB_TRIG       1.194850574      1.79455494
GENDER         0.338328242      1.88055787</code></pre>
<p>As usual the connection must be closed</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="datashield.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datashield.logout</span>(conns)</span></code></pre></div>
</div>
<div id="analysis-from-multiple-studies" class="section level3" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Analysis from multiple studies</h3>
<p>Now, let us illustrate a similar analysis with multiple studies. In this case we see results aggregated across all three studies.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="datashield.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DSOpal)</span>
<span id="cb181-2"><a href="datashield.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dsBaseClient)</span>
<span id="cb181-3"><a href="datashield.html#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="datashield.html#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prepare login data and resources to assign</span></span>
<span id="cb181-5"><a href="datashield.html#cb181-5" aria-hidden="true" tabindex="-1"></a>builder <span class="ot">&lt;-</span> DSI<span class="sc">::</span><span class="fu">newDSLoginBuilder</span>()</span>
<span id="cb181-6"><a href="datashield.html#cb181-6" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server =</span> <span class="st">&quot;study1&quot;</span>, <span class="at">url =</span> <span class="st">&quot;https://opal-demo.obiba.org&quot;</span>, </span>
<span id="cb181-7"><a href="datashield.html#cb181-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">user =</span> <span class="st">&quot;dsuser&quot;</span>, <span class="at">password =</span> <span class="st">&quot;password&quot;</span>, </span>
<span id="cb181-8"><a href="datashield.html#cb181-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">resource =</span> <span class="st">&quot;RSRC.CNSIM1&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;OpalDriver&quot;</span>)</span>
<span id="cb181-9"><a href="datashield.html#cb181-9" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server =</span> <span class="st">&quot;study2&quot;</span>, <span class="at">url =</span> <span class="st">&quot;https://opal-demo.obiba.org&quot;</span>, </span>
<span id="cb181-10"><a href="datashield.html#cb181-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">user =</span> <span class="st">&quot;dsuser&quot;</span>, <span class="at">password =</span> <span class="st">&quot;password&quot;</span>, </span>
<span id="cb181-11"><a href="datashield.html#cb181-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">resource =</span> <span class="st">&quot;RSRC.CNSIM2&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;OpalDriver&quot;</span>)</span>
<span id="cb181-12"><a href="datashield.html#cb181-12" aria-hidden="true" tabindex="-1"></a>builder<span class="sc">$</span><span class="fu">append</span>(<span class="at">server =</span> <span class="st">&quot;study3&quot;</span>, <span class="at">url =</span> <span class="st">&quot;https://opal-demo.obiba.org&quot;</span>, </span>
<span id="cb181-13"><a href="datashield.html#cb181-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">user =</span> <span class="st">&quot;dsuser&quot;</span>, <span class="at">password =</span> <span class="st">&quot;password&quot;</span>, </span>
<span id="cb181-14"><a href="datashield.html#cb181-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">resource =</span> <span class="st">&quot;RSRC.CNSIM3&quot;</span>, <span class="at">driver =</span> <span class="st">&quot;OpalDriver&quot;</span>)</span>
<span id="cb181-15"><a href="datashield.html#cb181-15" aria-hidden="true" tabindex="-1"></a>logindata <span class="ot">&lt;-</span> builder<span class="sc">$</span><span class="fu">build</span>()</span>
<span id="cb181-16"><a href="datashield.html#cb181-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-17"><a href="datashield.html#cb181-17" aria-hidden="true" tabindex="-1"></a><span class="co"># login and assign resources</span></span>
<span id="cb181-18"><a href="datashield.html#cb181-18" aria-hidden="true" tabindex="-1"></a>conns <span class="ot">&lt;-</span> <span class="fu">datashield.login</span>(<span class="at">logins =</span> logindata, <span class="at">assign =</span> <span class="cn">TRUE</span>, <span class="at">symbol =</span> <span class="st">&quot;res&quot;</span>)</span>
<span id="cb181-19"><a href="datashield.html#cb181-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-20"><a href="datashield.html#cb181-20" aria-hidden="true" tabindex="-1"></a><span class="co"># assigned objects are of class ResourceClient (and others)</span></span>
<span id="cb181-21"><a href="datashield.html#cb181-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.class</span>(<span class="st">&quot;res&quot;</span>)</span></code></pre></div>
<pre><code>$study1
[1] &quot;SQLResourceClient&quot; &quot;ResourceClient&quot;    &quot;R6&quot;               

$study2
[1] &quot;TidyFileResourceClient&quot; &quot;FileResourceClient&quot;     &quot;ResourceClient&quot;         &quot;R6&quot;                    

$study3
[1] &quot;TidyFileResourceClient&quot; &quot;FileResourceClient&quot;     &quot;ResourceClient&quot;         &quot;R6&quot;                    </code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="datashield.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coerce ResourceClient objects to data.frames</span></span>
<span id="cb183-2"><a href="datashield.html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (DataSHIELD config allows as.resource.data.frame() assignment function </span></span>
<span id="cb183-3"><a href="datashield.html#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for the purpose of the demo)</span></span>
<span id="cb183-4"><a href="datashield.html#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="fu">datashield.assign.expr</span>(conns, <span class="at">symbol =</span> <span class="st">&quot;D&quot;</span>, </span>
<span id="cb183-5"><a href="datashield.html#cb183-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expr =</span> <span class="fu">quote</span>(<span class="fu">as.resource.data.frame</span>(res, <span class="at">strict =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb183-6"><a href="datashield.html#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.class</span>(<span class="st">&quot;D&quot;</span>)</span></code></pre></div>
<pre><code>$study1
[1] &quot;data.frame&quot;

$study2
[1] &quot;data.frame&quot;

$study3
[1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="datashield.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do usual dsBase analysis</span></span>
<span id="cb185-2"><a href="datashield.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.summary</span>(<span class="st">&#39;D$LAB_HDL&#39;</span>)</span></code></pre></div>
<pre><code>$study1
$study1$class
[1] &quot;numeric&quot;

$study1$length
[1] 2163

$study1$`quantiles &amp; mean`
      5%      10%      25%      50%      75%      90%      95%     Mean 
0.875240 1.047400 1.300000 1.581000 1.844500 2.090000 2.210900 1.569416 


$study2
$study2$class
[1] &quot;numeric&quot;

$study2$length
[1] 3088

$study2$`quantiles &amp; mean`
      5%      10%      25%      50%      75%      90%      95%     Mean 
0.850280 1.032200 1.294000 1.563000 1.840000 2.077000 2.225000 1.556648 


$study3
$study3$class
[1] &quot;numeric&quot;

$study3$length
[1] 4128

$study3$`quantiles &amp; mean`
      5%      10%      25%      50%      75%      90%      95%     Mean 
0.876760 1.039200 1.304000 1.589000 1.856000 2.098800 2.244200 1.574687 </code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="datashield.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vector types are not necessarily the same depending on the data reader that was used</span></span>
<span id="cb187-2"><a href="datashield.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.class</span>(<span class="st">&#39;D$GENDER&#39;</span>)</span></code></pre></div>
<pre><code>$study1
[1] &quot;integer&quot;

$study2
[1] &quot;haven_labelled&quot; &quot;vctrs_vctr&quot;     &quot;double&quot;        

$study3
[1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="datashield.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.asFactor</span>(<span class="st">&#39;D$GENDER&#39;</span>, <span class="st">&#39;GENDER&#39;</span>)</span></code></pre></div>
<pre><code>$all.unique.levels
[1] &quot;0&quot; &quot;1&quot;

$return.message
[1] &quot;Data object &lt;GENDER&gt; correctly created in all specified data sources&quot;</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="datashield.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ds.summary</span>(<span class="st">&#39;GENDER&#39;</span>)</span></code></pre></div>
<pre><code>$study1
$study1$class
[1] &quot;factor&quot;

$study1$length
[1] 2163

$study1$categories
[1] &quot;0&quot; &quot;1&quot;

$study1$`count of &#39;0&#39;`
[1] 1092

$study1$`count of &#39;1&#39;`
[1] 1071


$study2
$study2$class
[1] &quot;factor&quot;

$study2$length
[1] 3088

$study2$categories
[1] &quot;0&quot; &quot;1&quot;

$study2$`count of &#39;0&#39;`
[1] 1585

$study2$`count of &#39;1&#39;`
[1] 1503


$study3
$study3$class
[1] &quot;factor&quot;

$study3$length
[1] 4128

$study3$categories
[1] &quot;0&quot; &quot;1&quot;

$study3$`count of &#39;0&#39;`
[1] 2091

$study3$`count of &#39;1&#39;`
[1] 2037</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="datashield.html#cb193-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">ds.glm</span>(<span class="st">&quot;DIS_DIAB ~ LAB_TRIG + GENDER&quot;</span>, <span class="at">data =</span> <span class="st">&quot;D&quot;</span> , <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb193-2"><a href="datashield.html#cb193-2" aria-hidden="true" tabindex="-1"></a>mod<span class="sc">$</span>coeff</span></code></pre></div>
<pre><code>              Estimate Std. Error    z-value       p-value low0.95CI.LP high0.95CI.LP       P_OR
(Intercept) -4.7792110 0.21081170 -22.670521 8.755236e-114   -5.1923944   -4.36602770 0.00833261
LAB_TRIG     0.3035931 0.05487436   5.532514  3.156737e-08    0.1960414    0.41114488 1.35471774
GENDER      -0.4455989 0.20797931  -2.142516  3.215202e-02   -0.8532309   -0.03796695 0.64044060
            low0.95CI.P_OR high0.95CI.P_OR
(Intercept)    0.005527953      0.01254229
LAB_TRIG       1.216577226      1.50854390
GENDER         0.426036242      0.96274475</code></pre>
<p><em>NOTE</em>: the outcome variable must be a 0/1 or a factor variable with two categories. The DataSHIELD function <code>ds.asFactor()</code> can be used to solve problems when having character variables. You can create a new object in the server that is a factor variable that can be passed in the left side of the formula indicated by <code>~</code>.</p>
<p>We can also perform a meta-analysis approach</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="datashield.html#cb195-1" aria-hidden="true" tabindex="-1"></a>mod.meta <span class="ot">&lt;-</span> <span class="fu">ds.glmSLMA</span>(<span class="st">&quot;DIS_DIAB ~ LAB_TRIG + GENDER&quot;</span>, </span>
<span id="cb195-2"><a href="datashield.html#cb195-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">dataName =</span> <span class="st">&quot;D&quot;</span> , <span class="at">family=</span><span class="st">&quot;binomial&quot;</span>)</span></code></pre></div>
<pre><code>

SAVING SERVERSIDE glm OBJECT AS: &lt; new.glm.obj &gt;</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="datashield.html#cb197-1" aria-hidden="true" tabindex="-1"></a>mod.meta</span></code></pre></div>
<pre><code>$output.summary
$output.summary$study1
$output.summary$study1$rank
[1] 3

$output.summary$study1$aic
[1] 256.0324

$output.summary$study1$iter
[1] 7

$output.summary$study1$converged
[1] TRUE

$output.summary$study1$boundary
[1] FALSE

$output.summary$study1$na.action
$output.summary$study1$na.action$na.action
[1] &quot;na.omit&quot;


$output.summary$study1$call
glm(formula = formula, family = binomial, data = D, x = TRUE)

$output.summary$study1$terms
DIS_DIAB ~ LAB_TRIG + GENDER
attr(,&quot;variables&quot;)
list(DIS_DIAB, LAB_TRIG, GENDER)
attr(,&quot;factors&quot;)
         LAB_TRIG GENDER
DIS_DIAB        0      0
LAB_TRIG        1      0
GENDER          0      1
attr(,&quot;term.labels&quot;)
[1] &quot;LAB_TRIG&quot; &quot;GENDER&quot;  
attr(,&quot;order&quot;)
[1] 1 1
attr(,&quot;intercept&quot;)
[1] 1
attr(,&quot;response&quot;)
[1] 1
attr(,&quot;.Environment&quot;)
&lt;environment: R_GlobalEnv&gt;
attr(,&quot;predvars&quot;)
list(DIS_DIAB, LAB_TRIG, GENDER)
attr(,&quot;dataClasses&quot;)
 DIS_DIAB  LAB_TRIG    GENDER 
&quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; 

$output.summary$study1$contrasts
NULL

$output.summary$study1$aliased
(Intercept)    LAB_TRIG      GENDER 
      FALSE       FALSE       FALSE 

$output.summary$study1$dispersion
[1] 1

$output.summary$study1$data
[1] &quot;D&quot;

$output.summary$study1$df
[1]    3 1798    3

$output.summary$study1$Ntotal
[1] 2163

$output.summary$study1$Nvalid
[1] 1801

$output.summary$study1$Nmissing
[1] 362

$output.summary$study1$cov.unscaled
            (Intercept)    LAB_TRIG      GENDER
(Intercept)   0.2069613 -0.03908510 -0.10930695
LAB_TRIG     -0.0390851  0.01076627  0.01218552
GENDER       -0.1093069  0.01218552  0.19147673

$output.summary$study1$cov.scaled
            (Intercept)    LAB_TRIG      GENDER
(Intercept)   0.2069613 -0.03908510 -0.10930695
LAB_TRIG     -0.0390851  0.01076627  0.01218552
GENDER       -0.1093069  0.01218552  0.19147673

$output.summary$study1$offset
NULL

$output.summary$study1$weights
NULL

$output.summary$study1$VarCovMatrix
            (Intercept)    LAB_TRIG      GENDER
(Intercept)   0.2069613 -0.03908510 -0.10930695
LAB_TRIG     -0.0390851  0.01076627  0.01218552
GENDER       -0.1093069  0.01218552  0.19147673

$output.summary$study1$CorrMatrix
           [,1]       [,2]       [,3]
[1,]  1.0000000 -0.8280071 -0.5490922
[2,] -0.8280071  1.0000000  0.2683820
[3,] -0.5490922  0.2683820  1.0000000

$output.summary$study1$deviance.null
[1] 263.5124

$output.summary$study1$df.null
[1] 1800

$output.summary$study1$deviance.resid
[1] 250.0324

$output.summary$study1$df.resid
[1] 1798

$output.summary$study1$formula
DIS_DIAB ~ LAB_TRIG + GENDER

$output.summary$study1$family

Family: binomial 
Link function: logit 


$output.summary$study1$coefficients
              Estimate Std. Error     z value     Pr(&gt;|z|)
(Intercept) -5.1696619  0.4549299 -11.3636438 6.344210e-30
LAB_TRIG     0.3813891  0.1037606   3.6756625 2.372330e-04
GENDER      -0.2260851  0.4375805  -0.5166709 6.053859e-01


$output.summary$study2
$output.summary$study2$rank
[1] 3

$output.summary$study2$aic
[1] 342.4653

$output.summary$study2$iter
[1] 7

$output.summary$study2$converged
[1] TRUE

$output.summary$study2$boundary
[1] FALSE

$output.summary$study2$na.action
$output.summary$study2$na.action$na.action
[1] &quot;na.omit&quot;


$output.summary$study2$call
glm(formula = formula, family = binomial, data = D, x = TRUE)

$output.summary$study2$terms
DIS_DIAB ~ LAB_TRIG + GENDER
attr(,&quot;variables&quot;)
list(DIS_DIAB, LAB_TRIG, GENDER)
attr(,&quot;factors&quot;)
         LAB_TRIG GENDER
DIS_DIAB        0      0
LAB_TRIG        1      0
GENDER          0      1
attr(,&quot;term.labels&quot;)
[1] &quot;LAB_TRIG&quot; &quot;GENDER&quot;  
attr(,&quot;order&quot;)
[1] 1 1
attr(,&quot;intercept&quot;)
[1] 1
attr(,&quot;response&quot;)
[1] 1
attr(,&quot;.Environment&quot;)
&lt;environment: R_GlobalEnv&gt;
attr(,&quot;predvars&quot;)
list(DIS_DIAB, LAB_TRIG, GENDER)
attr(,&quot;dataClasses&quot;)
 DIS_DIAB  LAB_TRIG    GENDER 
&quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; 

$output.summary$study2$contrasts
NULL

$output.summary$study2$aliased
(Intercept)    LAB_TRIG      GENDER 
      FALSE       FALSE       FALSE 

$output.summary$study2$dispersion
[1] 1

$output.summary$study2$data
[1] &quot;D&quot;

$output.summary$study2$df
[1]    3 2523    3

$output.summary$study2$Ntotal
[1] 3088

$output.summary$study2$Nvalid
[1] 2526

$output.summary$study2$Nmissing
[1] 562

$output.summary$study2$cov.unscaled
            (Intercept)     LAB_TRIG       GENDER
(Intercept)  0.15592059 -0.032943895 -0.078409244
LAB_TRIG    -0.03294390  0.009761457  0.009976858
GENDER      -0.07840924  0.009976858  0.155990467

$output.summary$study2$cov.scaled
            (Intercept)     LAB_TRIG       GENDER
(Intercept)  0.15592059 -0.032943895 -0.078409244
LAB_TRIG    -0.03294390  0.009761457  0.009976858
GENDER      -0.07840924  0.009976858  0.155990467

$output.summary$study2$offset
NULL

$output.summary$study2$weights
NULL

$output.summary$study2$VarCovMatrix
            (Intercept)     LAB_TRIG       GENDER
(Intercept)  0.15592059 -0.032943895 -0.078409244
LAB_TRIG    -0.03294390  0.009761457  0.009976858
GENDER      -0.07840924  0.009976858  0.155990467

$output.summary$study2$CorrMatrix
           [,1]       [,2]       [,3]
[1,]  1.0000000 -0.8444344 -0.5027667
[2,] -0.8444344  1.0000000  0.2556745
[3,] -0.5027667  0.2556745  1.0000000

$output.summary$study2$deviance.null
[1] 351.8674

$output.summary$study2$df.null
[1] 2525

$output.summary$study2$deviance.resid
[1] 336.4653

$output.summary$study2$df.resid
[1] 2523

$output.summary$study2$formula
DIS_DIAB ~ LAB_TRIG + GENDER

$output.summary$study2$family

Family: binomial 
Link function: logit 


$output.summary$study2$coefficients
              Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept) -5.0254035 0.39486781 -12.726800 4.196922e-37
LAB_TRIG     0.3462886 0.09880009   3.504943 4.567058e-04
GENDER      -0.4550068 0.39495629  -1.152043 2.493032e-01


$output.summary$study3
$output.summary$study3$rank
[1] 3

$output.summary$study3$aic
[1] 565.7245

$output.summary$study3$iter
[1] 7

$output.summary$study3$converged
[1] TRUE

$output.summary$study3$boundary
[1] FALSE

$output.summary$study3$na.action
$output.summary$study3$na.action$na.action
[1] &quot;na.omit&quot;


$output.summary$study3$call
glm(formula = formula, family = binomial, data = D, x = TRUE)

$output.summary$study3$terms
DIS_DIAB ~ LAB_TRIG + GENDER
attr(,&quot;variables&quot;)
list(DIS_DIAB, LAB_TRIG, GENDER)
attr(,&quot;factors&quot;)
         LAB_TRIG GENDER
DIS_DIAB        0      0
LAB_TRIG        1      0
GENDER          0      1
attr(,&quot;term.labels&quot;)
[1] &quot;LAB_TRIG&quot; &quot;GENDER&quot;  
attr(,&quot;order&quot;)
[1] 1 1
attr(,&quot;intercept&quot;)
[1] 1
attr(,&quot;response&quot;)
[1] 1
attr(,&quot;.Environment&quot;)
&lt;environment: R_GlobalEnv&gt;
attr(,&quot;predvars&quot;)
list(DIS_DIAB, LAB_TRIG, GENDER)
attr(,&quot;dataClasses&quot;)
 DIS_DIAB  LAB_TRIG    GENDER 
&quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; 

$output.summary$study3$contrasts
NULL

$output.summary$study3$aliased
(Intercept)    LAB_TRIG      GENDER 
      FALSE       FALSE       FALSE 

$output.summary$study3$dispersion
[1] 1

$output.summary$study3$data
[1] &quot;D&quot;

$output.summary$study3$df
[1]    3 3470    3

$output.summary$study3$Ntotal
[1] 4128

$output.summary$study3$Nvalid
[1] 3473

$output.summary$study3$Nmissing
[1] 655

$output.summary$study3$cov.unscaled
            (Intercept)     LAB_TRIG       GENDER
(Intercept)  0.08830240 -0.020976682 -0.043516621
LAB_TRIG    -0.02097668  0.007175979  0.005655775
GENDER      -0.04351662  0.005655775  0.087660938

$output.summary$study3$cov.scaled
            (Intercept)     LAB_TRIG       GENDER
(Intercept)  0.08830240 -0.020976682 -0.043516621
LAB_TRIG    -0.02097668  0.007175979  0.005655775
GENDER      -0.04351662  0.005655775  0.087660938

$output.summary$study3$offset
NULL

$output.summary$study3$weights
NULL

$output.summary$study3$VarCovMatrix
            (Intercept)     LAB_TRIG       GENDER
(Intercept)  0.08830240 -0.020976682 -0.043516621
LAB_TRIG    -0.02097668  0.007175979  0.005655775
GENDER      -0.04351662  0.005655775  0.087660938

$output.summary$study3$CorrMatrix
           [,1]       [,2]       [,3]
[1,]  1.0000000 -0.8333165 -0.4946134
[2,] -0.8333165  1.0000000  0.2255010
[3,] -0.4946134  0.2255010  1.0000000

$output.summary$study3$deviance.null
[1] 573.3634

$output.summary$study3$df.null
[1] 3472

$output.summary$study3$deviance.resid
[1] 559.7245

$output.summary$study3$df.resid
[1] 3470

$output.summary$study3$formula
DIS_DIAB ~ LAB_TRIG + GENDER

$output.summary$study3$family

Family: binomial 
Link function: logit 


$output.summary$study3$coefficients
              Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept) -4.4316966 0.29715719 -14.913644 2.686808e-50
LAB_TRIG     0.2304324 0.08471115   2.720213 6.523986e-03
GENDER      -0.5416610 0.29607590  -1.829467 6.732971e-02


$output.summary$input.beta.matrix.for.SLMA
            betas study 1 betas study 2 betas study 3
(Intercept)    -5.1696619    -5.0254035    -4.4316966
LAB_TRIG        0.3813891     0.3462886     0.2304324
GENDER         -0.2260851    -0.4550068    -0.5416610

$output.summary$input.se.matrix.for.SLMA
            ses study 1 ses study 2 ses study 3
(Intercept)   0.4549299  0.39486781  0.29715719
LAB_TRIG      0.1037606  0.09880009  0.08471115
GENDER        0.4375805  0.39495629  0.29607590


$num.valid.studies
[1] 3

$betamatrix.all
            betas study 1 betas study 2 betas study 3
(Intercept)    -5.1696619    -5.0254035    -4.4316966
LAB_TRIG        0.3813891     0.3462886     0.2304324
GENDER         -0.2260851    -0.4550068    -0.5416610

$sematrix.all
            ses study 1 ses study 2 ses study 3
(Intercept)   0.4549299  0.39486781  0.29715719
LAB_TRIG      0.1037606  0.09880009  0.08471115
GENDER        0.4375805  0.39495629  0.29607590

$betamatrix.valid
            betas study 1 betas study 2 betas study 3
(Intercept)    -5.1696619    -5.0254035    -4.4316966
LAB_TRIG        0.3813891     0.3462886     0.2304324
GENDER         -0.2260851    -0.4550068    -0.5416610

$sematrix.valid
            ses study 1 ses study 2 ses study 3
(Intercept)   0.4549299  0.39486781  0.29715719
LAB_TRIG      0.1037606  0.09880009  0.08471115
GENDER        0.4375805  0.39495629  0.29607590

$SLMA.pooled.ests.matrix
             pooled.ML      se.ML pooled.REML    se.REML  pooled.FE      se.FE
(Intercept) -4.7583891 0.21049116  -4.7914954 0.24960238 -4.7583890 0.21049103
LAB_TRIG     0.3077898 0.05466193   0.3077898 0.05466193  0.3077898 0.05466193
GENDER      -0.4460209 0.20832970  -0.4460209 0.20832970 -0.4460209 0.20832970

$is.object.created
[1] &quot;A data object &lt;new.glm.obj&gt; has been created in all specified data sources&quot;

$validity.check
[1] &quot;&lt;new.glm.obj&gt; appears valid in all sources&quot;</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="datashield.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datashield.logout</span>(conns)</span></code></pre></div>
<p>and visualize the results using some R packages</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="datashield.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(meta)</span>
<span id="cb200-2"><a href="datashield.html#cb200-2" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> mod.meta<span class="sc">$</span>output.summary<span class="sc">$</span>input.beta.matrix.for.SLMA</span>
<span id="cb200-3"><a href="datashield.html#cb200-3" aria-hidden="true" tabindex="-1"></a>ses <span class="ot">&lt;-</span> mod.meta<span class="sc">$</span>output.summary<span class="sc">$</span>input.se.matrix.for.SLMA</span>
<span id="cb200-4"><a href="datashield.html#cb200-4" aria-hidden="true" tabindex="-1"></a>betas</span></code></pre></div>
<pre><code>            betas study 1 betas study 2 betas study 3
(Intercept)    -5.1696619    -5.0254035    -4.4316966
LAB_TRIG        0.3813891     0.3462886     0.2304324
GENDER         -0.2260851    -0.4550068    -0.5416610</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="datashield.html#cb202-1" aria-hidden="true" tabindex="-1"></a>ses</span></code></pre></div>
<pre><code>            ses study 1 ses study 2 ses study 3
(Intercept)   0.4549299  0.39486781  0.29715719
LAB_TRIG      0.1037606  0.09880009  0.08471115
GENDER        0.4375805  0.39495629  0.29607590</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="datashield.html#cb204-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">metagen</span>(betas[<span class="st">&quot;LAB_TRIG&quot;</span>,], ses[<span class="st">&quot;LAB_TRIG&quot;</span>,])</span>
<span id="cb204-2"><a href="datashield.html#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">forest</span>(res, <span class="at">layout=</span><span class="st">&quot;JAMA&quot;</span>)</span></code></pre></div>
<p><img src="fig/unnamed-chunk-80-1.png" width="672" /></p>
</div>
</div>
<div id="tips-and-tricks" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Tips and tricks</h2>
<p>The user can see in <a href="http://opaldoc.obiba.org/en/latest/admin/installation.html">this link</a> how to create and install an Opal server. Next we illustrate how to deal with some of the basics for setting up a server to be used within DataSHIELD environment.</p>
<p>In order to do that, we are using our Opal demo server available here: <a href="https://opal-demo.obiba.org/" class="uri">https://opal-demo.obiba.org/</a></p>
<p>This is the how an Opal looks like once the user enters the credentials:</p>
<ul>
<li>username: <code>administrator</code></li>
<li>password: <code>password</code></li>
</ul>
<div class="figure">
<img src="fig/opal_1.png" alt="" />
<p class="caption">Opal demo main page</p>
</div>
<div id="how-to-create-a-new-project-into-opal" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> How to create a new project into OPAL</h3>
<div id="manually" class="section level4" number="6.7.1.1">
<h4><span class="header-section-number">6.7.1.1</span> Manually</h4>
<p>The tab <code>Projects</code> (top-left) goes to the projects available in the Opal demo</p>
<div class="figure">
<img src="fig/opal_2.png" alt="" />
<p class="caption">Opal demo projects</p>
</div>
<p>A new project can be created by clicking on <code>+Add Project</code> tab. Then this information must be filled in</p>
<div class="figure">
<img src="fig/opal_3.png" alt="" />
<p class="caption">Adding a new project to Opal</p>
</div>
</div>
<div id="using-r" class="section level4" number="6.7.1.2">
<h4><span class="header-section-number">6.7.1.2</span> Using R</h4>
<p>A project can be created using the following R code:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="datashield.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(opalr)</span>
<span id="cb205-2"><a href="datashield.html#cb205-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">opal.login</span>(<span class="at">username=</span><span class="st">&quot;administrator&quot;</span>, <span class="at">password=</span><span class="st">&quot;password&quot;</span>,</span>
<span id="cb205-3"><a href="datashield.html#cb205-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">url=</span><span class="st">&quot;https://opal-demo.obiba.org&quot;</span>)</span>
<span id="cb205-4"><a href="datashield.html#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="datashield.html#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A general purpose project, with a data storage</span></span>
<span id="cb205-6"><a href="datashield.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.project_create</span>(o, <span class="st">&quot;projectName&quot;</span>, <span class="at">database=</span><span class="cn">TRUE</span>)</span>
<span id="cb205-7"><a href="datashield.html#cb205-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-8"><a href="datashield.html#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co"># A project that can hold only resources and views (no persisted data)</span></span>
<span id="cb205-9"><a href="datashield.html#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.project_create</span>(o, <span class="st">&quot;projectName&quot;</span>)</span>
<span id="cb205-10"><a href="datashield.html#cb205-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-11"><a href="datashield.html#cb205-11" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.logout</span>(o)</span></code></pre></div>
<p>See also the other <code>opal.project_*</code> functions.</p>
</div>
</div>
<div id="how-to-upload-a-new-resource-into-opal" class="section level3" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> How to upload a new resource into OPAL</h3>
<div id="create_manually" class="section level4" number="6.7.2.1">
<h4><span class="header-section-number">6.7.2.1</span> Manually</h4>
<p>Once a new project has been created, a new resource can be uploaded by clicking on project’s name. In this case, let us assume that we are working on RSRC project that has been created to illustrate the main examples in this bookdown. After clicking on that project this window will appear</p>
<div class="figure">
<img src="fig/opal_4.png" alt="" />
<p class="caption">Tables, variables and resources from an Opal project</p>
</div>
<p>Here we can observe that this project contains 16 resources a no tables or variables. We can add a new resource by clicking on the “link tab” (see red circle)</p>
<div class="figure">
<img src="fig/opal_4b.png" alt="" />
<p class="caption">Going to the resources of a given project</p>
</div>
<p>Then a new resource can be added by clicking on the <code>+Add Resource</code> tab</p>
<div class="figure">
<img src="fig/opal_5.png" alt="" />
<p class="caption">Adding a resource of a given project</p>
</div>
<p>Then this window will appear and information for your resource must be filled in</p>
<div class="figure">
<img src="fig/opal_6.png" alt="" />
<p class="caption">Adding a resource of a given project</p>
</div>
<p>The different types of resources have been described Chapter <a href="#resourcer"><strong>??</strong></a></p>
</div>
<div id="using-r-1" class="section level4" number="6.7.2.2">
<h4><span class="header-section-number">6.7.2.2</span> Using R</h4>
<p>A resource can be added to a project by a simple function call, assuming that you know how to express the URL to the resource:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="datashield.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(opalr)</span>
<span id="cb206-2"><a href="datashield.html#cb206-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">opal.login</span>(<span class="st">&quot;administrator&quot;</span>,<span class="st">&quot;password&quot;</span>, </span>
<span id="cb206-3"><a href="datashield.html#cb206-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">url=</span><span class="st">&quot;https://opal-demo.obiba.org&quot;</span>)</span>
<span id="cb206-4"><a href="datashield.html#cb206-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-5"><a href="datashield.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.resource_create</span>(o, <span class="st">&quot;RSRC&quot;</span>, <span class="st">&quot;CNSIM3&quot;</span>, </span>
<span id="cb206-6"><a href="datashield.html#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> <span class="st">&quot;opal+https://opal-demo.obiba.org/ws/files/projects/RSRC/CNSIM3.zip&quot;</span>, </span>
<span id="cb206-7"><a href="datashield.html#cb206-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">&quot;csv&quot;</span>, <span class="at">secret =</span> <span class="st">&quot;EeTtQGIob6haio5bx6FUfVvIGkeZJfGq&quot;</span>)</span>
<span id="cb206-8"><a href="datashield.html#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="datashield.html#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="co"># to test the resource assignment</span></span>
<span id="cb206-10"><a href="datashield.html#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.assign.resource</span>(o, <span class="st">&quot;client&quot;</span>, <span class="st">&quot;RSRC.CNSIM3&quot;</span>)</span>
<span id="cb206-11"><a href="datashield.html#cb206-11" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.execute</span>(o, <span class="st">&quot;class(client)&quot;</span>)</span>
<span id="cb206-12"><a href="datashield.html#cb206-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-13"><a href="datashield.html#cb206-13" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.logout</span>(o)</span></code></pre></div>
<p>See also the other <code>opal.resource_*</code>functions.</p>
</div>
</div>
<div id="how-to-install-datashield-packages-into-opal-server" class="section level3" number="6.7.3">
<h3><span class="header-section-number">6.7.3</span> How to install DataSHIELD packages into OPAL server</h3>
<div id="manually-1" class="section level4" number="6.7.3.1">
<h4><span class="header-section-number">6.7.3.1</span> Manually</h4>
<div class="figure">
<img src="fig/opal_1_administration.png" alt="" />
<p class="caption">Administration tab at Opal</p>
</div>
<p>The tab <code>Administration</code> (red circle in the previous figure) allows the user access to the administration page</p>
<div class="figure">
<img src="fig/opal_7.png" alt="" />
<p class="caption">Administration tab at Opal</p>
</div>
<p>The <code>DataSHIELD</code> tab goes to the DataSHIELD administration details</p>
<div class="figure">
<img src="fig/opal_8.png" alt="" />
<p class="caption">Managing DataSHIELD packages in Opal</p>
</div>
<p>The tab <code>+Add Package</code> allow the user to install a DataSHIELD package either from the DataSHIELD repository or any other GitHub site</p>
<div class="figure">
<img src="fig/opal_9.png" alt="" />
<p class="caption">Install DataSHIELD packages in Opal</p>
</div>
</div>
<div id="using-r-2" class="section level4" number="6.7.3.2">
<h4><span class="header-section-number">6.7.3.2</span> Using R</h4>
<p>The user can install DataSHIELD R packages from CRAN or GitHub using the following R code:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="datashield.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(opalr)</span>
<span id="cb207-2"><a href="datashield.html#cb207-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">opal.login</span>(<span class="at">username=</span><span class="st">&quot;administrator&quot;</span>, <span class="at">password=</span><span class="st">&quot;password&quot;</span>,</span>
<span id="cb207-3"><a href="datashield.html#cb207-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">url=</span><span class="st">&quot;https://opal-demo.obiba.org&quot;</span>)</span>
<span id="cb207-4"><a href="datashield.html#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="datashield.html#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="co"># CRAN</span></span>
<span id="cb207-6"><a href="datashield.html#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dsadmin.install_package</span>(o, <span class="st">&quot;dsBase&quot;</span>)</span>
<span id="cb207-7"><a href="datashield.html#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub</span></span>
<span id="cb207-8"><a href="datashield.html#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dsadmin.install_github_package</span>(o, <span class="st">&quot;packageName&quot;</span>, <span class="at">username=</span><span class="st">&quot;orgOrUserName&quot;</span>)</span>
<span id="cb207-9"><a href="datashield.html#cb207-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-10"><a href="datashield.html#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.logout</span>(o)</span></code></pre></div>
<p>When developing a new DataSHIELD package, it can be convenient to directly upload the built package archive for being installed on the R server side. This can be done as follow:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="datashield.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(opalr)</span>
<span id="cb208-2"><a href="datashield.html#cb208-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">opal.login</span>(<span class="at">username=</span><span class="st">&quot;administrator&quot;</span>, <span class="at">password=</span><span class="st">&quot;password&quot;</span>,</span>
<span id="cb208-3"><a href="datashield.html#cb208-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">url=</span><span class="st">&quot;https://opal-demo.obiba.org&quot;</span>)</span>
<span id="cb208-4"><a href="datashield.html#cb208-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-5"><a href="datashield.html#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="co"># build and install the package archive</span></span>
<span id="cb208-6"><a href="datashield.html#cb208-6" aria-hidden="true" tabindex="-1"></a>packageArchivePath <span class="ot">&lt;-</span> devtools<span class="sc">::</span><span class="fu">build</span>(<span class="at">pkg=</span><span class="st">&quot;/path/to/the/packageName&quot;</span>)</span>
<span id="cb208-7"><a href="datashield.html#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dsadmin.install_local_package</span>(o, <span class="at">path=</span>packageArchivePath)</span>
<span id="cb208-8"><a href="datashield.html#cb208-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-9"><a href="datashield.html#cb208-9" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.logout</span>(o)</span></code></pre></div>
</div>
</div>
<div id="how-to-install-r-packages-into-opal-server" class="section level3" number="6.7.4">
<h3><span class="header-section-number">6.7.4</span> How to install R packages into OPAL server</h3>
<div id="manually-2" class="section level4" number="6.7.4.1">
<h4><span class="header-section-number">6.7.4.1</span> Manually</h4>
<p>All the dependencies in a DataSHIELD package are automatically installed when installing it on the Opal Server. If necessary the user can also use the <code>+Install</code> button from the Administration/R tab</p>
<div class="figure">
<img src="fig/opal_10.png" alt="" />
<p class="caption">Install DataSHIELD packages in Opal</p>
</div>
</div>
<div id="using-r-3" class="section level4" number="6.7.4.2">
<h4><span class="header-section-number">6.7.4.2</span> Using R</h4>
<p>The user can install R packages from CRAN, Bioconductor or GitHub using the following R code:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="datashield.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(opalr)</span>
<span id="cb209-2"><a href="datashield.html#cb209-2" aria-hidden="true" tabindex="-1"></a>o <span class="ot">&lt;-</span> <span class="fu">opal.login</span>(<span class="at">username=</span><span class="st">&quot;administrator&quot;</span>, <span class="at">password=</span><span class="st">&quot;password&quot;</span>,</span>
<span id="cb209-3"><a href="datashield.html#cb209-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">url=</span><span class="st">&quot;https://opal-demo.obiba.org&quot;</span>)</span>
<span id="cb209-4"><a href="datashield.html#cb209-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-5"><a href="datashield.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co"># CRAN</span></span>
<span id="cb209-6"><a href="datashield.html#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="fu">oadmin.install_package</span>(o, <span class="st">&quot;cranPackageName&quot;</span>)</span>
<span id="cb209-7"><a href="datashield.html#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bioconductor</span></span>
<span id="cb209-8"><a href="datashield.html#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="fu">oadmin.install_bioconductor_package</span>(o, <span class="st">&quot;biocPackageName&quot;</span>)</span>
<span id="cb209-9"><a href="datashield.html#cb209-9" aria-hidden="true" tabindex="-1"></a><span class="co"># GitHub</span></span>
<span id="cb209-10"><a href="datashield.html#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="fu">oadmin.install_github_package</span>(o, <span class="st">&quot;packageName&quot;</span>, <span class="at">username=</span><span class="st">&quot;orgOrUserName&quot;</span>, <span class="at">ref =</span> <span class="st">&quot;branchOrTagName&quot;</span>)</span>
<span id="cb209-11"><a href="datashield.html#cb209-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-12"><a href="datashield.html#cb209-12" aria-hidden="true" tabindex="-1"></a><span class="fu">opal.logout</span>(o)</span></code></pre></div>

</div>
</div>
</div>
</div>










            </section>

          </div>
        </div>
      </div>
<a href="model-fitting.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/isglobal-brge/Aprendizaje_Automatico_1/tree/master/docs04-DataSHIELD.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
